

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Execution semantics in the IPython kernel &mdash; IPython 7.9.0.dev documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="New IPython Console Lexer" href="lexer.html" />
    <link rel="prev" title="Making simple Python wrapper kernels" href="wrapperkernels.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> IPython
          

          
          </a>

          
            
            
              <div class="version">
                7.9.0.dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">IPython Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew/index.html">What’s new in IPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html">Configuration and customization</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer’s guide for third party tools and libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="how_ipython_works.html">How IPython works</a></li>
<li class="toctree-l2"><a class="reference internal" href="wrapperkernels.html">Making simple Python wrapper kernels</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Execution semantics in the IPython kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="lexer.html">New IPython Console Lexer</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Overview of the IPython configuration system</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputhook_app.html">IPython GUI Support Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../coredev/index.html">Guide for IPython core Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">The IPython API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sphinxext.html">IPython Sphinx Directive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About IPython</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IPython</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Developer’s guide for third party tools and libraries</a> &raquo;</li>
        
      <li>Execution semantics in the IPython kernel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/development/execution.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This documentation covers a development version of IPython. The development
version may differ significantly from the latest stable release.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This documentation covers IPython versions 6.0 and higher. Beginning with
version 6.0, IPython stopped supporting compatibility with Python versions
lower than 3.3 including all versions of Python 2.7.</p>
<p>If you are looking for an IPython version compatible with Python 2.7,
please use the IPython 5.x LTS release and refer to its documentation (LTS
is the long term support release).</p>
</div>
<div class="section" id="execution-semantics-in-the-ipython-kernel">
<span id="execution-semantics"></span><h1>Execution semantics in the IPython kernel<a class="headerlink" href="#execution-semantics-in-the-ipython-kernel" title="Permalink to this headline">¶</a></h1>
<p>The execution of user code consists of the following phases:</p>
<ol class="arabic simple">
<li><p>Fire the <code class="docutils literal notranslate"><span class="pre">pre_execute</span></code> event.</p></li>
<li><p>Fire the <code class="docutils literal notranslate"><span class="pre">pre_run_cell</span></code> event unless silent is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p>Execute the <code class="docutils literal notranslate"><span class="pre">code</span></code> field, see below for details.</p></li>
<li><p>If execution succeeds, expressions in <code class="docutils literal notranslate"><span class="pre">user_expressions</span></code> are computed.
This ensures that any error in the expressions don’t affect the main code execution.</p></li>
<li><p>Fire the <code class="docutils literal notranslate"><span class="pre">post_execute</span></code> event.</p></li>
<li><p>Fire the <code class="docutils literal notranslate"><span class="pre">post_run_cell</span></code> event unless silent is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../config/callbacks.html"><span class="doc">IPython Events</span></a></p>
</div>
<p>To understand how the <code class="docutils literal notranslate"><span class="pre">code</span></code> field is executed, one must know that Python
code can be compiled in one of three modes (controlled by the <code class="docutils literal notranslate"><span class="pre">mode</span></code> argument
to the <a class="reference external" href="https://docs.python.org/3/library/functions.html#compile" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> builtin):</p>
<dl>
<dt><em>single</em></dt><dd><p>Valid for a single interactive statement (though the source can contain
multiple lines, such as a for loop).  When compiled in this mode, the
generated bytecode contains special instructions that trigger the calling of
<a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.displayhook" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.displayhook()</span></code></a> for any expression in the block that returns a value.
This means that a single statement can actually produce multiple calls to
<a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.displayhook" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.displayhook()</span></code></a>, if for example it contains a loop where each
iteration computes an unassigned expression would generate 10 calls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">i</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</dd>
<dt><em>exec</em></dt><dd><p>An arbitrary amount of source code, this is how modules are compiled.
<a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.displayhook" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.displayhook()</span></code></a> is <em>never</em> implicitly called.</p>
</dd>
<dt><em>eval</em></dt><dd><p>A single expression that returns a value.  <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.displayhook" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.displayhook()</span></code></a> is <em>never</em>
implicitly called.</p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">code</span></code> field is split into individual blocks each of which is valid for
execution in ‘single’ mode, and then:</p>
<ul class="simple">
<li><p>If there is only a single block: it is executed in ‘single’ mode.</p></li>
<li><p>If there is more than one block:</p>
<ul>
<li><p>if the last one is a single line long, run all but the last in ‘exec’ mode
and the very last one in ‘single’ mode.  This makes it easy to type simple
expressions at the end to see computed values.</p></li>
<li><p>if the last one is no more than two lines long, run all but the last in
‘exec’ mode and the very last one in ‘single’ mode.  This makes it easy to
type simple expressions at the end to see computed values.  - otherwise
(last one is also multiline), run all in ‘exec’ mode</p></li>
<li><p>otherwise (last one is also multiline), run all in ‘exec’ mode as a single
unit.</p></li>
</ul>
</li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lexer.html" class="btn btn-neutral float-right" title="New IPython Console Lexer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wrapperkernels.html" class="btn btn-neutral float-left" title="Making simple Python wrapper kernels" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The IPython Development Team
      <span class="lastupdated">
        Last updated on Aug 30, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>